{"version":3,"file":"index.js","sources":["../src/js/01-gallery.js"],"sourcesContent":["import axios from 'axios';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport iziToast from 'izitoast';\nclass ImageGallery {\n  constructor(searchInput, searchButton, gallery, loadingSpinner, loadMoreButton) {\n    this.searchInput = searchInput;\n    this.searchButton = searchButton;\n    this.gallery = gallery;\n    this.loadingSpinner = loadingSpinner;\n    this.loadMoreButton = loadMoreButton;\n    this.currentPage = 1;\n    this.currentQuery = '';\n    this.lightbox = new SimpleLightbox('.gallery a', {\n      captions: true,\n      captionsData: 'alt',\n      captionDelay: 250\n    });\n\n    this.initialize();\n  }\n\n  initialize() {\n    this.loadMoreButton.classList.add('hidden')\n    this.searchButton.addEventListener('click', this.handleSearch.bind(this));\n    this.loadMoreButton.addEventListener('click', this.loadMoreImages.bind(this));\n  }\n\n  async handleSearch() {\n    this.currentQuery = this.searchInput.value;\n    this.currentPage = 1;\n    this.gallery.innerHTML = ''; \n    await this.fetchImages(); \n  }\n\n  async loadMoreImages() {\n    this.currentPage++; \n\n    await this.fetchImages(); \n    this.scrollGallery();\n  }\n  scrollGallery() {\n    const galleryItems = this.gallery.querySelectorAll('.gallery-item');\n    if (galleryItems.length > 1) {\n      const itemHeight = galleryItems[0].getBoundingClientRect().height;\n      window.scrollBy({ top: itemHeight * 2, behavior: 'smooth' });\n    }\n  }\n  async fetchImages() {\n    const url = `https://pixabay.com/api/?key=45876667-2d0330e34270c14d815b5249b&q=${this.currentQuery}&image_type=photo&orientation=horizontal&safesearch=true&page=${this.currentPage}&page_per=40`;\n\n    this.loadingSpinner.classList.remove('hidden');\n    this.loadMoreButton.classList.remove('hidden')\n    try {\n      const response = await axios.get(url);\n      const data = response.data;\n      console.log(data)\n      const galleryItems = data.hits\n      .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\n        return `\n          <li class=\"gallery-item\">\n            <a href=\"${largeImageURL}\" data-lightbox=\"gallery\" data-title=\"${tags}\">\n              <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\"/>\n            </a>\n            <div class=\"bottom-item\">\n              <div class=\"bottom-item-div\"><p class=\"bottom-item-p1\">Likes</p><p class=\"bottom-item-p2\">${likes}</p></div>\n              <div class=\"bottom-item-div\"><p class=\"bottom-item-p1\">Views</p><p class=\"bottom-item-p2\">${views}</p></div>\n              <div class=\"bottom-item-div\"><p class=\"bottom-item-p1\">Comments</p><p class=\"bottom-item-p2\">${comments}</p></div>\n              <div class=\"bottom-item-div\"><p class=\"bottom-item-p1\">Downloads</p><p class=\"bottom-item-p2\">${downloads}</p></div>\n            </div>\n          </li>\n        `;\n      })\n      .join(\"\");\n      this.gallery.innerHTML += galleryItems;\n\n     \n      if (data.hits.length===0) {\n        iziToast.info({\n          title: 'Info',\n          message: 'Sorry, there are no images matching your search query. Please try again!',\n          position: 'topRight',\n          backgroundColor: 'red',\n        });\n        this.loadingSpinner.classList.add('hidden');\n        this.loadMoreButton.classList.add('hidden')\n        return;\n      }\nconsole.log(data.totalHits-(this.currentPage*40))\n\n      if (data.totalHits-(this.currentPage*40) < 40 && this.currentPage >= 1) {\n        this.loadMoreButton.classList.add('hidden'); \n        this.loadingSpinner.classList.add('hidden');\n\n        iziToast.info({\n          title: 'Info',\n          message: `We're sorry, but you've reached the end of search results`,\n          position: 'topRight',\n          backgroundColor: 'yellow',\n        });\n        return;\n      }\n\n\n      this.loadMoreButton.classList.remove()\n      this.lightbox.refresh(); \n    } catch (error) {\n      console.error('Hata:', error);\n    } finally {\n      this.loadingSpinner.classList.add('hidden'); \n    }\n  }\n}\n\nconst searchInput = document.getElementById('search-input');\nconst searchButton = document.getElementById('search-button');\nconst gallery = document.getElementById('gallery');\nconst loadingSpinner = document.getElementById('loading-spinner');\nconst loadMoreButton = document.getElementById('load-more-button');\n\nconst imageGallery = new ImageGallery(searchInput, searchButton, gallery, loadingSpinner, loadMoreButton);\n"],"names":["ImageGallery","searchInput","searchButton","gallery","loadingSpinner","loadMoreButton","SimpleLightbox","galleryItems","itemHeight","url","data","axios","webformatURL","largeImageURL","tags","likes","views","comments","downloads","iziToast","error"],"mappings":"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"}