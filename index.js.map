{"version":3,"file":"index.js","sources":["../src/js/01-gallery.js"],"sourcesContent":["import axios from 'axios';\r\nimport SimpleLightbox from 'simplelightbox';\r\nimport 'simplelightbox/dist/simple-lightbox.min.css';\r\nimport iziToast from 'izitoast';\r\nclass ImageGallery {\r\n  constructor(searchInput, searchButton, gallery, loadingSpinner, loadMoreButton) {\r\n    this.searchInput = searchInput;\r\n    this.searchButton = searchButton;\r\n    this.gallery = gallery;\r\n    this.loadingSpinner = loadingSpinner;\r\n    this.loadMoreButton = loadMoreButton;\r\n    this.lightbox = new SimpleLightbox('.gallery a', {\r\n      captions: true,\r\n      captionsData: 'alt',\r\n      captionDelay: 250\r\n    });\r\n    this.queryParams={\r\n      key:\"45876667-2d0330e34270c14d815b5249b\", \r\n      q:this.searchInput.value,\r\n      page:\"1\",\r\n      image_type:\"photo\",\r\n      orientation:\"horizontal\",\r\n      safesearch:\"true\",\r\n      page_per:\"40\",\r\n  \r\n    };\r\n    this.initialize();\r\n  }\r\n\r\n  initialize() {\r\n    \r\n    this.loadMoreButton.classList.add('hidden')\r\n    this.searchButton.addEventListener('click', this.handleSearch.bind(this));\r\n    this.loadMoreButton.addEventListener('click', this.loadMoreImages.bind(this));\r\n\r\n  }\r\n\r\n  async handleSearch() {\r\n    \r\n    this.queryParams.q=this.searchInput.value\r\n    this.queryParams.page = 1;\r\n    this.gallery.innerHTML = ''; \r\n    await this.fetchImages(); \r\n  }\r\n\r\n  async loadMoreImages() {\r\n    this.queryParams.page++; \r\n    await this.fetchImages(); \r\n\r\n    this.scrollGallery();\r\n  }\r\n  scrollGallery() {\r\n    const galleryItems = this.gallery.querySelectorAll('.gallery-item');\r\n    if (galleryItems.length > 1) {\r\n      const itemHeight = galleryItems[0].getBoundingClientRect().height;\r\n      window.scrollBy({ top: itemHeight * 2, behavior: 'smooth' });\r\n    }\r\n  }\r\n  async fetchImages() {\r\n    const url = `https://pixabay.com/api/`;\r\n\r\n    this.loadingSpinner.classList.remove('hidden');\r\n    this.loadMoreButton.classList.remove('hidden')\r\n    try {\r\n      const response = await axios.get(url,{params:this.queryParams});\r\n      const data = response.data;\r\n      const galleryItems = data.hits\r\n      .map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) => {\r\n        return `\r\n          <li class=\"gallery-item\">\r\n            <a href=\"${largeImageURL}\" data-lightbox=\"gallery\" data-title=\"${tags}\">\r\n              <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\"/>\r\n            </a>\r\n            <div class=\"bottom-item\">\r\n              <div class=\"bottom-item-div\"><p class=\"bottom-item-p1\">Likes</p><p class=\"bottom-item-p2\">${likes}</p></div>\r\n              <div class=\"bottom-item-div\"><p class=\"bottom-item-p1\">Views</p><p class=\"bottom-item-p2\">${views}</p></div>\r\n              <div class=\"bottom-item-div\"><p class=\"bottom-item-p1\">Comments</p><p class=\"bottom-item-p2\">${comments}</p></div>\r\n              <div class=\"bottom-item-div\"><p class=\"bottom-item-p1\">Downloads</p><p class=\"bottom-item-p2\">${downloads}</p></div>\r\n            </div>\r\n          </li>\r\n        `;\r\n      })\r\n      .join(\"\");\r\n      this.gallery.innerHTML += galleryItems;\r\n\r\n     \r\n      if (data.hits.length===0) {\r\n        iziToast.info({\r\n          title: 'Info',\r\n          message: 'Sorry, there are no images matching your search query. Please try again!',\r\n          position: 'topRight',\r\n          backgroundColor: 'red',\r\n        });\r\n        this.loadingSpinner.classList.add('hidden');\r\n        this.loadMoreButton.classList.add('hidden')\r\n        return;\r\n      }\r\n\r\n      if (data.totalHits-(this.queryParams.page*40) < 40 && this.queryParams.page >= 1) {\r\n        this.loadMoreButton.classList.add('hidden'); \r\n        this.loadingSpinner.classList.add('hidden');\r\n\r\n        iziToast.info({\r\n          title: 'Info',\r\n          message: `We're sorry, but you've reached the end of search results`,\r\n          position: 'topRight',\r\n          backgroundColor: 'yellow',\r\n        });\r\n        return;\r\n      }\r\n\r\n\r\n      this.loadMoreButton.classList.remove()\r\n      this.lightbox.refresh(); \r\n    } catch (error) {\r\n      console.error('Hata:', error);\r\n    } finally {\r\n      this.loadingSpinner.classList.add('hidden'); \r\n    }\r\n  }\r\n}\r\n\r\nconst searchInput = document.getElementById('search-input');\r\nconst searchButton = document.getElementById('search-button');\r\nconst gallery = document.getElementById('gallery');\r\nconst loadingSpinner = document.getElementById('loading-spinner');\r\nconst loadMoreButton = document.getElementById('load-more-button');\r\n\r\nconst imageGallery = new ImageGallery(searchInput, searchButton, gallery, loadingSpinner, loadMoreButton);\r\n"],"names":["ImageGallery","searchInput","searchButton","gallery","loadingSpinner","loadMoreButton","SimpleLightbox","galleryItems","itemHeight","url","data","axios","webformatURL","largeImageURL","tags","likes","views","comments","downloads","iziToast","error"],"mappings":"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"}